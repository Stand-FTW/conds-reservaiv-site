"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[8218],{61443:(C,c,t)=>{var i,s,a;t.d(c,{ez:()=>a,tP:()=>i}),(s=i||(i={})).Documents="DOCUMENTS",s.Data="DATA",s.Library="LIBRARY",s.Cache="CACHE",s.External="EXTERNAL",s.ExternalStorage="EXTERNAL_STORAGE",function(s){s.UTF8="utf8",s.ASCII="ascii",s.UTF16="utf16"}(a||(a={}))},81067:(C,c,t)=>{t.d(c,{fy:()=>p,tP:()=>a.tP});var i=t(47423),a=t(61443);const p=(0,i.fo)("Filesystem",{web:()=>t.e(6364).then(t.bind(t,96364)).then(m=>new m.FilesystemWeb)})},48218:(C,c,t)=>{t.r(c),t.d(c,{HomePageModule:()=>x});var i=t(97582),a=t(98274),p=t(36895),m=t(24006),s=t(48058),E=t(92216),M=t(83111),N=t(35593),I=t(12453),U=t(21327),B=t(91795),O=t(1997),D=t(24382),L=t(52054),b=t(39528),u=t(15861);var z=t(50727),P=t(26388),R=t(81067),A=t(59136),$=t(89535),H=t(80529),v=t(99038);let f=class{constructor(n){this.http=n}listSelf(){return this.http.get(`${v.Hz.baseURL}/notificacoes`,{responseType:"json"})}listByUser(n){return this.http.get(`${v.Hz.baseURL}/notificacoes/${n}`,{responseType:"json"})}markAsReadById(n){return this.http.patch(`${v.Hz.baseURL}/notificacoes/${n}/read`,{responseType:"json"})}markAsUnreadById(n){return this.http.patch(`${v.Hz.baseURL}/notificacoes/${n}/unread`,{responseType:"json"})}};f.ctorParameters=()=>[{type:H.eN}],f=(0,i.gn)([(0,a.GSi)({providedIn:"root"})],f);var V=t(34758),r=t(24658);var w=t(59256),T=t(45088),K=t(9683),Z=t(5292),W=t(18109),X=t(40363);let d=class{constructor(n,e,o,l,y,S,_,tt,nt,et){this.route=n,this.storage=e,this.usersService=o,this.notificacaoService=l,this.toastService=y,this.modal=S,this.preferencesService=_,this.emailService=tt,this.alertController=nt,this.platform=et,this.notificacoes=[],this.condominioId=Z.Fj,this.subscriptions=new z.w0}ngOnInit(){this.itemsNotificacao=[{label:"Op\xe7\xf5es",items:[{label:"Atualizar",icon:"pi pi-fw pi-refresh",command:()=>{this.loadNotificacoes()}}]}],this.itemsUsers=[{label:"Op\xe7\xf5es",items:[{label:"Atualizar",icon:"pi pi-fw pi-refresh",command:()=>{this.loadColaboradores()}}]}],this.user=this.storage.getCompleteLocalUser(),this.loadColaboradores(),this.loadNotificacoes(),this.loadMoradores()}ngOnDestroy(){this.subscriptions.unsubscribe()}ionViewDidEnter(){var n=this;return(0,u.Z)(function*(){const e=n.platform.platforms();(e.includes("android")||e.includes("ios"))&&(yield n.requestCameraPermission(),yield n.requestFilePermission())})()}loadNotificacoes(){const n=this.notificacaoService.listSelf().subscribe(e=>{this.notificacoes=e});this.subscriptions.add(n)}loadColaboradores(n=1){const e=this.usersService.listUsers({condominio_id:this.condominioId},{order:A.L.ASC,page:n,take:10}).subscribe(o=>{o.data=o.data.filter(l=>l.id!==this.user.id),this.colaboradores=o});this.subscriptions.add(e)}paginarColaborador(n){const e=n.page+1;this.loadColaboradores(e)}loadMoradores(n=1){const e=this.usersService.listUsers({condominio_id:this.condominioId,tipo_usuario:W.X.USUARIO},{order:A.L.ASC,page:n,take:10}).subscribe(o=>{o.data=o.data.filter(l=>l.id!==this.user.id),this.moradores=o});this.subscriptions.add(e)}paginarMorador(n){const e=n.page+1;this.loadMoradores(e)}getNotificacaoIcon(n){return class G{static getIconByTipo(n){switch(n){case r.S.CARGA:return"pi pi-cloud-upload";case r.S.MENSAGEM_COMUM:return"pi pi-envelope";case r.S.MENSAGEM_PRIORITARIA:return"pi pi-info-circle";case r.S.MENSAGEM_PROGRAMADA:return"pi pi-directions";default:return"pi pi-comment"}}}.getIconByTipo(n.tipo)}getNotificacaoColor(n){switch(n){case r.c.AVISO:return"text-yellow-500";case r.c.ERRO:return"text-pink-500";case r.c.INFO:return"text-blue-500";case r.c.SUCESSO:return"text-green-500";default:return"text-blue-500"}}openPerfil(){this.showModal(T.E,{user:this.user,enableMessageAndNotification:!0})}openMembro(n){this.showModal(T.E,{user:n})}goToPDV(){this.route.navigateByUrl("pdv")}goToPrestacaoServico(){}goToAssinatura(){}goToSendEmail(n){this.emailService.addEmailToList(n.email);this.route.navigate(["/comunicacao-email"],{queryParams:{tab:"email-send"}})}getTheme(){const n=this.preferencesService.getThemePreference();return this.inAndOutDash.backgroundColor=this.preferencesService.surfaceBackground,"dark"==n?n:void 0}requestCameraPermission(){var n=this;return(0,u.Z)(function*(){try{const e=yield P.V1.checkPermissions();if(console.log(`Permiss\xf5es \xe0 c\xe2mera: ${e}`),"granted"!=e.camera||"granted"!=e.photos){const o=yield n.alertController.create({header:"Permiss\xf5es \xe0 c\xe2mera e galeria",message:"Necess\xe1rio para realizar opera\xe7\xf5es com anexo de encomendas",buttons:["OK"]});yield o.present(),yield o.onDidDismiss(),yield P.V1.requestPermissions({permissions:["camera","photos"]})}}catch(e){console.error("N\xe3o foi poss\xedvel pedir permiss\xe3o \xe0 c\xe2mera/fotos"),console.error(e)}})()}requestFilePermission(){var n=this;return(0,u.Z)(function*(){try{const e=yield R.fy.checkPermissions();if(console.log(`Permiss\xf5es \xe0 arquivos: ${e}`),"granted"!=e.publicStorage){const o=yield n.alertController.create({header:"Permiss\xf5es \xe0 arquivos",message:"Necess\xe1rio para poder salvar arquivos e comprovantes",buttons:["OK"],backdropDismiss:!1});yield o.present(),yield o.onDidDismiss(),yield R.fy.requestPermissions()}}catch(e){console.error("N\xe3o foi poss\xedvel pedir permiss\xe3o aos arquivos"),console.error(e)}})()}showModal(n,e){var o=this;return(0,u.Z)(function*(){const l=yield o.modal.create({component:n,backdropDismiss:!1,cssClass:"modal-size-100",componentProps:e});return l.onDidDismiss().then(y=>{const{data:S}=y;S&&(o.user=o.storage.getCompleteLocalUser())}),yield l.present()})()}};d.ctorParameters=()=>[{type:b.F0},{type:$.V},{type:V.K},{type:f},{type:w.D},{type:s.IN},{type:K.y},{type:X.j},{type:s.Br},{type:s.t4}],d=(0,i.gn)([(0,a.wA2)({selector:"app-home",template:'<ion-header [translucent]="true">\n  <ion-toolbar>\n    <ion-buttons slot="start">\n      <ion-menu-button></ion-menu-button>\n    </ion-buttons>\n    <ion-title>Home</ion-title>\n  </ion-toolbar>\n</ion-header>\n\n<ion-content appScrollTheme>\n  <ng-container *ngIf="user && colaboradores && moradores">\n    <div class="flex flex-column flex-auto wall-background py-2 h-screen">\n      <div class="surface-section p-5">\n        <div (click)="openPerfil()" class="flex align-items-start flex-column lg:flex-row \n        lg:justify-content-between cursor-pointer">\n          <div class="flex align-items-start flex-column md:flex-row">\n            <img [src]="user.avatar_url" class="mr-5 mb-3 lg:mb-0 default-avatar border-1 border-primary" />\n            <div>\n              <span class="text-900 font-medium text-3xl">{{ user.nome }}</span>\n              <div class="flex align-items-center flex-wrap text-sm">\n                <div class="mr-5 mt-3">\n                  <span class="font-medium text-500">Condom\xednio</span>\n                  <div class="text-700 mt-2">{{ user.condominio?.nome || "Sem condom\xednio definida" }}</div>\n                </div>\n              </div>\n            </div>\n          </div>\n          <div class="mt-3 lg:mt-0">\n            <span class="font-medium text-500">{{ user.perfil.nome }}</span>\n          </div>\n        </div>\n      </div>\n\n      <div class="p-5">\n        <div class="grid">\n          <ng-container *ngIf="simplesDash">\n\n            <div class="col-12 lg:col-4 xl:col-4">\n              <div class="surface-card shadow-2 p-3 border-1 border-50 border-round">\n                <div class="flex justify-content-between mb-3">\n                  <div>\n                    <span class="block text-500 font-medium mb-3">Chamados</span>\n                    <div class="text-900 font-medium text-xl">Total: 0</div>\n                  </div>\n                  <div class="flex align-items-center justify-content-center bg-blue-100 border-round cursor-pointer"\n                    style="width:2.5rem;height:2.5rem" (click)="goToPDV()">\n                    <i class="pi pi-shopping-cart text-blue-500 text-xl"></i>\n                  </div>\n                </div>\n                <span class="text-blue-500 font-medium">Quantidade: </span>\n                <span class="text-500">0</span>\n              </div>\n            </div>\n          </ng-container>\n\n\n          <div id="notificacoes" class="col-12 xl:col-4 md:col-6">\n            <div class="surface-card shadow-2 border-round p-4">\n              <div class="flex align-items-center justify-content-between mb-3">\n                <div class="text-900 font-medium text-xl">Notifica\xe7\xf5es</div>\n                <div>\n                  <button pButton pRipple icon="pi pi-ellipsis-v" class="p-button-text p-button-plain p-button-rounded"\n                    (click)="menu.toggle($event)"></button>\n                  <p-menu #menu [popup]="true" [model]="itemsNotificacao" appendTo="body"></p-menu>\n                </div>\n              </div>\n              <ng-container *ngIf="notificacoes">\n                <ul class="list-none p-0 m-0">\n                  <li *ngFor="let n of notificacoes"\n                    class="py-3 border-bottom-1 surface-border flex md:align-items-start md:justify-content-between flex-column md:flex-row">\n                    <div class="flex align-items-start mr-0 lg:mr-5">\n                      <button pButton pRipple type="button" [icon]="getNotificacaoIcon(n)"\n                        class="p-button-rounded p-button-secondary p-button-text mr-3 mt-4"></button>\n                      <div>\n                        <span class="text-900 font-medium block mb-2">{{ n.nome }}</span>\n                        <div class="text-700 mb-2"> {{ n.descricao }}</div>\n                        <a [ngClass]="{\n                          \'warning\' : \'text-yellow-500\', \n                        \'danger\' : \'text-pink-500\', \n                        \'info\' : \'text-blue-500\', \n                        \'success\' : \'text-green-500\'\n                      }[n.status]">\n                          <span>{{ n.status | convertStatus }}</span>\n                        </a>\n                      </div>\n                    </div>\n                    <span class="block text-500 font-medium ml-7 md:ml-5 mt-2 md:mt-0">{{ n.created_at | timeSince\n                      }}</span>\n                  </li>\n                </ul>\n              </ng-container>\n\n              <ng-container *ngIf="!notificacoes || notificacoes.length == 0">\n                <div class="border-circle border-1 border-primary">\n                  <app-attention-surface title="Aten\xe7\xe3o" subtitle="Vazio"\n                    message="Nenhuma notifica\xe7\xe3o encontrada"></app-attention-surface>\n                </div>\n              </ng-container>\n            </div>\n          </div>\n\n          <div id="colaboradores" class="col-12 xl:col-4 md:col-6">\n            <div class="surface-card shadow-2 border-round p-4">\n              <div class="flex justify-content-between align-items-center mb-5">\n                <span class="text-xl text-900 font-medium">Colaboradores do condom\xednio</span>\n                <div>\n                  <button pButton pRipple icon="pi pi-ellipsis-v" class="p-button-text p-button-plain p-button-rounded"\n                    (click)="colab.toggle($event)"></button>\n                  <p-menu #colab [popup]="true" [model]="itemsUsers" appendTo="body"></p-menu>\n                </div>\n              </div>\n              <ul class="list-none p-0 m-0">\n                <li *ngFor="let u of colaboradores.data;"\n                  class="flex flex-column md:flex-row md:align-items-center md:justify-content-between mb-4">\n                  <div class="flex">\n                    <div>\n                      <span class="block text-900 font-medium mb-1">{{ u.nome }}</span>\n                      <div class="text-600 text-xs">{{ u.perfil.nome }}</div>\n                    </div>\n                  </div>\n                  <div class="mt-2 md:mt-0 flex flex-nowrap">\n                    \x3c!--<button pButton pRipple class="p-button-text p-button-plain p-button-rounded mr-1"\n                      icon="pi pi-envelope" (click)="goToSendEmail(u)"></button>\n                    \n                      <button pButton pRipple class="p-button-text p-button-plain p-button-rounded mr-1"\n                      icon="pi pi-comment"></button>\n                    <button pButton pRipple class="p-button-text p-button-plain p-button-rounded mr-1"\n                      icon="pi pi-external-link" (click)="openMembro(u)"></button>\n                    --\x3e\n                  </div>\n                </li>\n              </ul>\n              <p-paginator [rows]="colaboradores.meta.take" [totalRecords]="colaboradores.meta.itemCount"\n                [pageLinkSize]="colaboradores.meta.pageCount" (onPageChange)="paginarColaborador($event)"></p-paginator>\n            </div>\n          </div>\n\n          <div id="moradores" class="col-12 xl:col-4 md:col-6">\n            <div class="surface-card shadow-2 border-round p-4">\n              <div class="flex justify-content-between align-items-center mb-5">\n                <span class="text-xl text-900 font-medium">Moradores do condom\xednio</span>\n                <div>\n                  <button pButton pRipple icon="pi pi-ellipsis-v" class="p-button-text p-button-plain p-button-rounded"\n                    (click)="mor.toggle($event)"></button>\n                  <p-menu #mor [popup]="true" [model]="itemsUsers" appendTo="body"></p-menu>\n                </div>\n              </div>\n              <ul class="list-none p-0 m-0">\n                <li *ngFor="let u of moradores.data;"\n                  class="flex flex-column md:flex-row md:align-items-center md:justify-content-between mb-4">\n                  <div class="flex">\n                    <div>\n                      <span class="block text-900 font-medium mb-1">{{ u.nome }}</span>\n                    </div>\n                  </div>\n                  <div class="mt-2 md:mt-0 flex flex-nowrap">\n\n                    \x3c!--\n                    <button pButton pRipple class="p-button-text p-button-plain p-button-rounded mr-1"\n                      icon="pi pi-envelope" (click)="goToSendEmail(u)"></button>\n                      <button pButton pRipple class="p-button-text p-button-plain p-button-rounded mr-1"\n                      icon="pi pi-comment"></button>\n                    <button pButton pRipple class="p-button-text p-button-plain p-button-rounded mr-1"\n                      icon="pi pi-external-link" (click)="openMembro(u)"></button>\n                    --\x3e\n                  </div>\n                </li>\n              </ul>\n              <p-paginator [rows]="moradores.meta.take" [totalRecords]="moradores.meta.itemCount"\n                [pageLinkSize]="moradores.meta.pageCount" (onPageChange)="paginarMorador($event)"></p-paginator>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  </ng-container>\n</ion-content>',styles:["ion-button {\n  min-width: 260px !important;\n  max-width: 260px !important;\n  overflow-wrap: break-word;\n  word-break: break-all;\n}"]})],d);const J=[{path:"",component:d}];let h=class{};h=(0,i.gn)([(0,a.LVF)({imports:[b.Bz.forChild(J)],exports:[b.Bz]})],h);var Q=t(85226),Y=t(58949),k=t(33909),q=t(91670);let x=class{};x=(0,i.gn)([(0,a.LVF)({imports:[p.ez,m.u5,s.Pc,N.hJ,B.T,I.EV,U.$9,O.U,D.S,E.uH,M.t,L.Ns.forRoot({echarts:()=>t.e(7581).then(t.bind(t,77581))}),h,Q.o,Y.d,k.L,q.A],declarations:[d]})],x)}}]);